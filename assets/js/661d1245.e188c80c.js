"use strict";(self.webpackChunkuppy_io=self.webpackChunkuppy_io||[]).push([[4864],{60288:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>u,contentTitle:()=>l,default:()=>h,frontMatter:()=>i,metadata:()=>c,toc:()=>p});var a=t(74848),r=t(28453),s=t(11470),o=t(19365);const i={slug:"/react"},l="React",c={id:"framework-integrations/react",title:"React",description:"React components for the Uppy UI plugins and a useUppyState hook.",source:"@site/docs/framework-integrations/react.mdx",sourceDirName:"framework-integrations",slug:"/react",permalink:"/docs/react",draft:!1,unlisted:!1,editUrl:"https://github.com/transloadit/uppy/blob/main/docs/framework-integrations/react.mdx",tags:[],version:"current",frontMatter:{slug:"/react"},sidebar:"tutorialSidebar",previous:{title:"Angular",permalink:"/docs/angular"},next:{title:"Svelte",permalink:"/docs/svelte"}},u={},p=[{value:"Install",id:"install",level:2},{value:"Use",id:"use",level:2},{value:"Components",id:"components",level:3},{value:"Examples",id:"examples",level:2},{value:"Example: basic component",id:"example-basic-component",level:3},{value:"Example: keep Uppy state and uploads while navigating between pages",id:"example-keep-uppy-state-and-uploads-while-navigating-between-pages",level:3},{value:"Example: updating Uppy\u2019s options dynamically based on props",id:"example-updating-uppys-options-dynamically-based-on-props",level:3},{value:"Example: dynamic params and signature for Transloadit",id:"example-dynamic-params-and-signature-for-transloadit",level:3}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.h1,{id:"react",children:"React"}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.a,{href:"https://facebook.github.io/react",children:"React"})," components for the Uppy UI plugins and a ",(0,a.jsx)(n.code,{children:"useUppyState"})," hook."]}),"\n",(0,a.jsx)(n.h2,{id:"install",children:"Install"}),"\n",(0,a.jsxs)(s.A,{children:[(0,a.jsx)(o.A,{value:"npm",label:"NPM",default:!0,children:(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:"npm install @uppy/react\n"})})}),(0,a.jsx)(o.A,{value:"yarn",label:"Yarn",children:(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:"yarn add @uppy/react\n"})})})]}),"\n",(0,a.jsx)(n.admonition,{type:"note",children:(0,a.jsxs)(n.p,{children:["You also need to install the UI plugin you want to use. For instance,\n",(0,a.jsx)(n.code,{children:"@uppy/dashboard"}),"."]})}),"\n",(0,a.jsx)(n.h2,{id:"use",children:"Use"}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.code,{children:"@uppy/react"})," exposes component wrappers for ",(0,a.jsx)(n.code,{children:"Dashboard"}),", ",(0,a.jsx)(n.code,{children:"DragDrop"}),", and all\nother UI elements. The components can be used with either ",(0,a.jsx)(n.a,{href:"https://facebook.github.io/react",children:"React"})," or\nAPI-compatible alternatives such as ",(0,a.jsx)(n.a,{href:"https://preactjs.com/",children:"Preact"}),"."]}),"\n",(0,a.jsx)(n.admonition,{type:"caution",children:(0,a.jsxs)(n.p,{children:["If you find yourself writing many instances of ",(0,a.jsx)(n.code,{children:"useState"})," and ",(0,a.jsx)(n.code,{children:"useEffect"})," to\nachieve something with Uppy in React, you are most likely breaking React best\npractices. Consider reading\n\u201c",(0,a.jsx)(n.a,{href:"https://react.dev/learn/you-might-not-need-an-effect",children:"You Might Not Need an Effect"}),"\u201d\nand looking at our examples below."]})}),"\n",(0,a.jsx)(n.h3,{id:"components",children:"Components"}),"\n",(0,a.jsxs)(n.p,{children:["The following components are exported from ",(0,a.jsx)(n.code,{children:"@uppy/react"}),":"]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"<Dashboard />"})," renders ",(0,a.jsx)(n.a,{href:"/docs/dashboard",children:(0,a.jsx)(n.code,{children:"@uppy/dashboard"})})]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"<DragDrop />"})," renders ",(0,a.jsx)(n.a,{href:"/docs/drag-drop",children:(0,a.jsx)(n.code,{children:"@uppy/drag-drop"})})]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"<ProgressBar />"})," renders ",(0,a.jsx)(n.a,{href:"/docs/progress-bar",children:(0,a.jsx)(n.code,{children:"@uppy/progress-bar"})})]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"<StatusBar />"})," renders ",(0,a.jsx)(n.a,{href:"/docs/status-bar",children:(0,a.jsx)(n.code,{children:"@uppy/status-bar"})})]}),"\n"]}),"\n","\n","\n",(0,a.jsx)(n.h2,{id:"examples",children:"Examples"}),"\n",(0,a.jsx)(n.h3,{id:"example-basic-component",children:"Example: basic component"}),"\n",(0,a.jsx)(n.p,{children:"Here we have a basic component which ties Uppy\u2019s state to the component. This\nmeans you can render multiple instances. But be aware that as your component\nunmounts, for instance because the user navigates to a different page, Uppy\u2019s\nstate will be lost and uploads will stop."}),"\n",(0,a.jsx)(n.admonition,{type:"note",children:(0,a.jsxs)(n.p,{children:["If you render multiple instances of Uppy, make sure to give each instance a\nunique ",(0,a.jsx)(n.code,{children:"id"}),"."]})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",children:"import React, { useEffect, useState } from 'react';\nimport Uppy from '@uppy/core';\nimport Webcam from '@uppy/webcam';\nimport { Dashboard } from '@uppy/react';\n\nimport '@uppy/core/dist/style.min.css';\nimport '@uppy/dashboard/dist/style.min.css';\nimport '@uppy/webcam/dist/style.min.css';\n\nfunction Component() {\n\t// IMPORTANT: passing an initializer function to prevent Uppy from being reinstantiated on every render.\n\tconst [uppy] = useState(() => new Uppy().use(Webcam));\n\n\treturn <Dashboard uppy={uppy} />;\n}\n"})}),"\n",(0,a.jsx)(n.h3,{id:"example-keep-uppy-state-and-uploads-while-navigating-between-pages",children:"Example: keep Uppy state and uploads while navigating between pages"}),"\n",(0,a.jsxs)(n.p,{children:["When you want Uppy\u2019s state to persist and keep uploads running between pages,\nyou can\n",(0,a.jsx)(n.a,{href:"https://react.dev/learn/sharing-state-between-components#lifting-state-up-by-example",children:"lift the state up"}),"."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",children:"import React, { useState, useEffect } from 'react';\nimport Uppy from '@uppy/core';\nimport { Dashboard } from '@uppy/react';\n\nfunction Page1() {\n\t// ...\n}\n\nfunction Page2({ uppy }) {\n\treturn (\n\t\t<>\n\t\t\t<p>{totalProgress}</p>\n\t\t\t<Dashboard id=\"dashboard\" uppy={uppy} />\n\t\t</>\n\t);\n}\n\nexport default function App() {\n\t// keeping the uppy instance alive above the pages the user can switch during uploading\n\tconst [uppy] = useState(() => new Uppy());\n\n\treturn (\n\t\t// Add your router here\n\t\t<>\n\t\t\t<Page1 />\n\t\t\t<Page2 uppy={uppy} />\n\t\t</>\n\t);\n}\n"})}),"\n",(0,a.jsx)(n.h3,{id:"example-updating-uppys-options-dynamically-based-on-props",children:"Example: updating Uppy\u2019s options dynamically based on props"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",children:"// ...\nfunction Component(props) {\n\t// IMPORTANT: passing an initializer function to prevent the state from recreating.\n\tconst [uppy] = useState(() => new Uppy().use(Webcam));\n\n\tuseEffect(() => {\n\t\tuppy.setOptions({ restrictions: props.restrictions });\n\t}, [props.restrictions]);\n\n\tuseEffect(() => {\n\t\tuppy.getPlugin('Webcam').setOptions({ modes: props.webcamModes });\n\t}, [props.webcamModes]);\n\n\treturn <Dashboard uppy={uppy} />;\n}\n"})}),"\n",(0,a.jsx)(n.h3,{id:"example-dynamic-params-and-signature-for-transloadit",children:"Example: dynamic params and signature for Transloadit"}),"\n",(0,a.jsxs)(n.p,{children:["When you go to production always make sure to set the ",(0,a.jsx)(n.code,{children:"signature"}),". ",(0,a.jsxs)(n.strong,{children:["Not using\n",(0,a.jsx)(n.a,{href:"https://transloadit.com/docs/topics/signature-authentication/",children:"Signature Authentication"}),"\ncan be a security risk"]}),". Signature Authentication is a security measure that\ncan prevent outsiders from tampering with your Assembly Instructions."]}),"\n",(0,a.jsxs)(n.p,{children:["Generating a signature should be done on the server to avoid leaking secrets. In\nReact, this could get awkward with a ",(0,a.jsx)(n.code,{children:"fetch"})," in a ",(0,a.jsx)(n.code,{children:"useEffect"})," and setting it to\n",(0,a.jsx)(n.code,{children:"useState"}),". Instead, it\u2019s easier to use the\n",(0,a.jsx)(n.a,{href:"/docs/transloadit#assemblyoptions",children:(0,a.jsx)(n.code,{children:"assemblyOptions"})})," option to ",(0,a.jsx)(n.code,{children:"fetch"})," the\nparams."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",children:"// ...\nfunction createUppy(userId) {\n\treturn new Uppy({ meta: { userId } }).use(Transloadit, {\n\t\tasync assemblyOptions(file) {\n\t\t\t// You can send meta data along for use in your template.\n\t\t\t// https://transloadit.com/docs/topics/assembly-instructions/#form-fields-in-instructions\n\t\t\tconst body = JSON.stringify({ userId: file.meta.userId });\n\t\t\tconst res = await fetch('/transloadit-params', { method: 'POST', body });\n\t\t\treturn response.json();\n\t\t},\n\t});\n}\n\nfunction Component({ userId }) {\n\t// IMPORTANT: passing an initializer function to prevent Uppy from being reinstantiated on every render.\n\tconst [uppy] = useState(() => createUppy(userId));\n\n\tuseEffect(() => {\n\t\tif (userId) {\n\t\t\t// Adding to global `meta` will add it to every file.\n\t\t\tuppy.setOptions({ meta: { userId } });\n\t\t}\n\t}, [uppy, userId]);\n}\n"})})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}},19365:(e,n,t)=>{t.d(n,{A:()=>o});t(96540);var a=t(18215);const r={tabItem:"tabItem_Ymn6"};var s=t(74848);function o(e){let{children:n,hidden:t,className:o}=e;return(0,s.jsx)("div",{role:"tabpanel",className:(0,a.A)(r.tabItem,o),hidden:t,children:n})}},11470:(e,n,t)=>{t.d(n,{A:()=>w});var a=t(96540),r=t(18215),s=t(23104),o=t(56347),i=t(205),l=t(57485),c=t(31682),u=t(89466);function p(e){return a.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,a.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function d(e){const{values:n,children:t}=e;return(0,a.useMemo)((()=>{const e=n??function(e){return p(e).map((e=>{let{props:{value:n,label:t,attributes:a,default:r}}=e;return{value:n,label:t,attributes:a,default:r}}))}(t);return function(e){const n=(0,c.X)(e,((e,n)=>e.value===n.value));if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[n,t])}function h(e){let{value:n,tabValues:t}=e;return t.some((e=>e.value===n))}function m(e){let{queryString:n=!1,groupId:t}=e;const r=(0,o.W6)(),s=function(e){let{queryString:n=!1,groupId:t}=e;if("string"==typeof n)return n;if(!1===n)return null;if(!0===n&&!t)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return t??null}({queryString:n,groupId:t});return[(0,l.aZ)(s),(0,a.useCallback)((e=>{if(!s)return;const n=new URLSearchParams(r.location.search);n.set(s,e),r.replace({...r.location,search:n.toString()})}),[s,r])]}function f(e){const{defaultValue:n,queryString:t=!1,groupId:r}=e,s=d(e),[o,l]=(0,a.useState)((()=>function(e){let{defaultValue:n,tabValues:t}=e;if(0===t.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(n){if(!h({value:n,tabValues:t}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${n}" but none of its children has the corresponding value. Available values are: ${t.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return n}const a=t.find((e=>e.default))??t[0];if(!a)throw new Error("Unexpected error: 0 tabValues");return a.value}({defaultValue:n,tabValues:s}))),[c,p]=m({queryString:t,groupId:r}),[f,y]=function(e){let{groupId:n}=e;const t=function(e){return e?`docusaurus.tab.${e}`:null}(n),[r,s]=(0,u.Dv)(t);return[r,(0,a.useCallback)((e=>{t&&s.set(e)}),[t,s])]}({groupId:r}),g=(()=>{const e=c??f;return h({value:e,tabValues:s})?e:null})();(0,i.A)((()=>{g&&l(g)}),[g]);return{selectedValue:o,selectValue:(0,a.useCallback)((e=>{if(!h({value:e,tabValues:s}))throw new Error(`Can't select invalid tab value=${e}`);l(e),p(e),y(e)}),[p,y,s]),tabValues:s}}var y=t(92303);const g={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var b=t(74848);function x(e){let{className:n,block:t,selectedValue:a,selectValue:o,tabValues:i}=e;const l=[],{blockElementScrollPositionUntilNextRender:c}=(0,s.a_)(),u=e=>{const n=e.currentTarget,t=l.indexOf(n),r=i[t].value;r!==a&&(c(n),o(r))},p=e=>{let n=null;switch(e.key){case"Enter":u(e);break;case"ArrowRight":{const t=l.indexOf(e.currentTarget)+1;n=l[t]??l[0];break}case"ArrowLeft":{const t=l.indexOf(e.currentTarget)-1;n=l[t]??l[l.length-1];break}}n?.focus()};return(0,b.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,r.A)("tabs",{"tabs--block":t},n),children:i.map((e=>{let{value:n,label:t,attributes:s}=e;return(0,b.jsx)("li",{role:"tab",tabIndex:a===n?0:-1,"aria-selected":a===n,ref:e=>l.push(e),onKeyDown:p,onClick:u,...s,className:(0,r.A)("tabs__item",g.tabItem,s?.className,{"tabs__item--active":a===n}),children:t??n},n)}))})}function j(e){let{lazy:n,children:t,selectedValue:r}=e;const s=(Array.isArray(t)?t:[t]).filter(Boolean);if(n){const e=s.find((e=>e.props.value===r));return e?(0,a.cloneElement)(e,{className:"margin-top--md"}):null}return(0,b.jsx)("div",{className:"margin-top--md",children:s.map(((e,n)=>(0,a.cloneElement)(e,{key:n,hidden:e.props.value!==r})))})}function v(e){const n=f(e);return(0,b.jsxs)("div",{className:(0,r.A)("tabs-container",g.tabList),children:[(0,b.jsx)(x,{...n,...e}),(0,b.jsx)(j,{...n,...e})]})}function w(e){const n=(0,y.A)();return(0,b.jsx)(v,{...e,children:p(e.children)},String(n))}},28453:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>i});var a=t(96540);const r={},s=a.createContext(r);function o(e){const n=a.useContext(s);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),a.createElement(s.Provider,{value:n},e.children)}}}]);