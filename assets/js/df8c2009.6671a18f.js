"use strict";(self.webpackChunkuppy_io=self.webpackChunkuppy_io||[]).push([[7985],{23111:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>l,contentTitle:()=>r,default:()=>c,frontMatter:()=>s,metadata:()=>a,toc:()=>d});var t=o(74848),i=o(28453);const s={title:"Uppy 2.4-2.7: Image Compressor, Transloadit Rate Limiting, ESM",date:new Date("2022-03-11T00:00:00.000Z"),authors:["aduh95","arturi","mifi","murderlon"],image:"https://uppy.io/img/blog/2.4-2.7/compressor.jpg",published:!0,slug:"2022/03/2.4-2.7"},r=void 0,a={permalink:"/blog/2022/03/2.4-2.7",editUrl:"https://github.com/transloadit/uppy.io/tree/main/blog/2022-03-2.4-2.7.md",source:"@site/blog/2022-03-2.4-2.7.md",title:"Uppy 2.4-2.7: Image Compressor, Transloadit Rate Limiting, ESM",description:"We\u2019re always looking for opportunities to teach Uppy cool new tricks, and the",date:"2022-03-11T00:00:00.000Z",tags:[],readingTime:3.32,hasTruncateMarker:!0,authors:[{email:"antoine@transloadit.com",name:"Antoine du Hamel",id:"aduh95",tagline:"Developer",imageURL:"https://github.com/aduh95.png",key:"aduh95"},{email:"artur@transloadit.com",name:"Artur Paikin",id:"artur",tagline:"Developer",imageURL:"https://github.com/arturi.png",key:"arturi"},{email:"mikael@transloadit.com",name:"Mikael Finstad",id:"mikael",tagline:"Developer",imageURL:"https://github.com/mifi.png",key:"mifi"},{email:"merlijn@transloadit.com",name:"Merlijn Vos",id:"merlijn",tagline:"Developer",imageURL:"https://github.com/murderlon.png",key:"murderlon"}],frontMatter:{title:"Uppy 2.4-2.7: Image Compressor, Transloadit Rate Limiting, ESM",date:"2022-03-11T00:00:00.000Z",authors:["aduh95","arturi","mifi","murderlon"],image:"https://uppy.io/img/blog/2.4-2.7/compressor.jpg",published:!0,slug:"2022/03/2.4-2.7"},unlisted:!1,prevItem:{title:"Uppy 3.0: Future-proof, conveniently easy, stable as ever",permalink:"/blog/2022/09/3.0"},nextItem:{title:"\ud83c\udf84 Uppy 2.1-2.3: Audio plugin, fast and efficient streaming for Companion, production-ready Unsplash, and more",permalink:"/blog/2021/12/2.1-2.3"}},l={authorsImageUrls:[void 0,void 0,void 0,void 0]},d=[{value:"Compressor",id:"compressor",level:2},{value:"Hosted Companion custom credentials",id:"hosted-companion-custom-credentials",level:2},{value:"Transloadit rate limiting",id:"transloadit-rate-limiting",level:2},{value:"Move to ESM",id:"move-to-esm",level:2},{value:"End to end: move to Cypress",id:"end-to-end-move-to-cypress",level:2},{value:"Lighter Bundle",id:"lighter-bundle",level:2},{value:"Companion improvements",id:"companion-improvements",level:2}];function p(e){const n={a:"a",blockquote:"blockquote",code:"code",h2:"h2",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(n.p,{children:["We\u2019re always looking for opportunities to teach Uppy cool new tricks, and the\npast few months have been no exception. Since our\n",(0,t.jsx)(n.a,{href:"https://uppy.io/blog/2021/12/2.1-2.3/",children:"most recent post"})," in December, Uppy has\ncontinued to receive a steady stream of updates. This post covers all the\nimprovements made in Uppy versions 2.4 through 2.7. Changes and additions\ninclude: image compression, improved Transloadit rate limiting and a lighter\nDashboard plugin. We\u2019ve also moved our end-to-end tests to Cypress, and are\nslowly converting plugins to ES modules (ESM)."]}),"\n",(0,t.jsx)(n.img,{className:"border",alt:"Uppy Compressor plugin showing compressed images notification",src:"/img/blog/2.4-2.7/compressor.jpg"}),"\n",(0,t.jsx)(n.h2,{id:"compressor",children:"Compressor"}),"\n",(0,t.jsxs)(n.p,{children:["Some of the most commonly uploaded files on the internet are images \u2014 photos,\nstock images, screenshots, and documents scans. Uppy now includes a new plugin\ncalled ",(0,t.jsx)(n.code,{children:"@uppy/compressor"})," that optimizes images (JPEG, PNG), saving on average\nup to 60% in size (roughly 18 MB for 10 images). It uses\n",(0,t.jsx)(n.a,{href:"https://github.com/fengyuanchen/compressorjs",children:"Compressor.js"})," under the hood."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.a,{href:"https://uppy.io/docs/compressor/",children:"Read the docs"})," and\n",(0,t.jsx)(n.a,{href:"https://uppy.io/examples/dashboard/",children:"try Compressor in action"}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"import Uppy from '@uppy/core';\nimport Compressor from '@uppy/compressor';\n\nconst uppy = new Uppy();\nuppy.use(Compressor);\n"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"@uppy/compressor"})," is also the first plugin that we are releasing as ESM,\nbackwards compatible as CJS, to test out how this works. Please report any\nissues."]}),"\n",(0,t.jsx)(n.h2,{id:"hosted-companion-custom-credentials",children:"Hosted Companion custom credentials"}),"\n",(0,t.jsxs)(n.p,{children:["It cannot be overstated that our\n",(0,t.jsx)(n.a,{href:"https://transloadit.com/docs/sdks/uppy/",children:"Transloadit-hosted"}),"\n",(0,t.jsx)(n.a,{href:"https://uppy.io/docs/companion/",children:"Companion Plugin"})," is the easiest secure way to\nallow your users pick files from cloud sources like Google Drive, Instagram,\nBox, etc. via Uppy. Up until now, however, that meant your users had to\nauthenticate their cloud account with Transloadit, preventing you from showing\nyour own logo instead. That has now been fixed! Head to ",(0,t.jsx)(n.code,{children:"Transloadit Console"})," /\n",(0,t.jsx)(n.code,{children:"Credentials"}),", scroll down to ",(0,t.jsx)(n.code,{children:"Third-party Credentials"}),", click on\n",(0,t.jsx)(n.code,{children:"Add new Credentials"}),", select ",(0,t.jsx)(n.code,{children:"Companion OAuth"}),", and voil\xe0!"]}),"\n",(0,t.jsx)(n.img,{className:"border",alt:"Transloadit Companion 3rd party credentials",src:"/img/blog/2.4-2.7/companion-3rd-party-oauth.jpg"}),"\n",(0,t.jsxs)(n.p,{children:["Try it out with the\n",(0,t.jsx)(n.a,{href:"https://transloadit.com/pricing/",children:"free Transloadit Community Plan \u2014 5GB / month and access to Companion"}),"."]}),"\n",(0,t.jsx)(n.h2,{id:"transloadit-rate-limiting",children:"Transloadit rate limiting"}),"\n",(0,t.jsxs)(n.p,{children:["We\u2019ve added rate limiting to Transloadit\n",(0,t.jsx)(n.a,{href:"https://github.com/transloadit/uppy/pull/3429",children:"assembly creation and status polling"}),",\nand ",(0,t.jsx)(n.a,{href:"https://github.com/transloadit/uppy/pull/3394",children:"tus retries"}),":"]}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"When the remote server responds with HTTP 429, all requests are paused for a\nwhile in the hope that it can resolve the rate limiting. Failed requests are\nnow also queued up after the retry delay. Before, they were scheduled for\nretry without being queued up, which would sometimes end up overflowing the\nlimit option."}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"As a result of this change, uploading many files at once has become even more\nrobust."}),"\n",(0,t.jsx)(n.h2,{id:"move-to-esm",children:"Move to ESM"}),"\n",(0,t.jsx)(n.p,{children:"The JavaScript ecosystem is moving towards ESM, and we want to follow suit. We\nare slowly starting to adopt ESM in Uppy packages. To do so, we integrated a\nplugin into our build system that transpiles ESM source code to CommonJS syntax,\nwhich is distributed with the npm package. Nothing will change on your end,\nthough \u2013 we know that not everyone is using tooling that support ESM, so we\u2019re\nholding on to CommonJS for the time being. Our plan is to refactor all official\nUppy plugins to ESM before Uppy 3.0 is released, and drop CommonJS in favor of\nESM in the npm packages at that point."}),"\n",(0,t.jsxs)(n.p,{children:["For details, see ",(0,t.jsx)(n.a,{href:"https://github.com/transloadit/uppy/pull/3468",children:"PR 3468"}),"."]}),"\n",(0,t.jsx)(n.h2,{id:"end-to-end-move-to-cypress",children:"End to end: move to Cypress"}),"\n",(0,t.jsxs)(n.p,{children:["Uppy has had end to end from the start, but the developer experience was less\nthan ideal with custom Webdriver.io + Selenium. The transition to\n",(0,t.jsx)(n.a,{href:"https://github.com/transloadit/uppy/pull/3444",children:"Cypress"})," allows us to write\ntests with ease and comfort, backed by great documentation."]}),"\n",(0,t.jsx)(n.h2,{id:"lighter-bundle",children:"Lighter Bundle"}),"\n",(0,t.jsxs)(n.p,{children:["We continue to look for ways to reduce Uppy\u2019s bundle size and modernize our\nbuild toolchain. This time, we\u2019ve replaced the\n",(0,t.jsx)(n.a,{href:"https://github.com/exif-js/exif-js",children:"Exifr.js"})," legacy bundle with the modern one\nwithout IE polyfills. Our Browserify bundler has been replaced with a modern and\nmore efficient ESBuild."]}),"\n",(0,t.jsx)(n.h2,{id:"companion-improvements",children:"Companion improvements"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Improved private IP check (#3403)"}),"\n",(0,t.jsx)(n.li,{children:"Implement periodic ping functionality (#3246)"}),"\n",(0,t.jsx)(n.li,{children:"Fix broken thumbnails for Box and Dropbox (#3460)"}),"\n",(0,t.jsx)(n.li,{children:"Fix unpslash author meta, sanitize metadata to strings and improve Companion\ntests (#3478)"}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["That\u2019s it for today! See the full\n",(0,t.jsx)(n.a,{href:"https://github.com/transloadit/uppy/blob/master/CHANGELOG.md#1300",children:"changelog"}),"\nfor more details."]})]})}function c(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(p,{...e})}):p(e)}},28453:(e,n,o)=>{o.d(n,{R:()=>r,x:()=>a});var t=o(96540);const i={},s=t.createContext(i);function r(e){const n=t.useContext(s);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),t.createElement(s.Provider,{value:n},e.children)}}}]);