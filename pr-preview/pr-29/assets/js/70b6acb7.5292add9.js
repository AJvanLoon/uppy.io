"use strict";(self.webpackChunkuppy_io=self.webpackChunkuppy_io||[]).push([[7391],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>c});var a=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var s=a.createContext({}),d=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},u=function(e){var t=d(e.components);return a.createElement(s.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,o=e.mdxType,r=e.originalType,s=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),m=d(n),c=o,h=m["".concat(s,".").concat(c)]||m[c]||p[c]||r;return n?a.createElement(h,i(i({ref:t},u),{},{components:n})):a.createElement(h,i({ref:t},u))}));function c(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var r=n.length,i=new Array(r);i[0]=m;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:o,i[1]=l;for(var d=2;d<r;d++)i[d]=n[d];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},3612:(e,t,n)=>{n.d(t,{Z:()=>h});var a=n(7294),o=n(6010),r=n(5281),i=n(5999);const l="admonition_LlT9",s="admonitionHeading_tbUL",d="admonitionIcon_kALy",u="admonitionContent_S0QG";const p={note:{infimaClassName:"secondary",iconComponent:function(){return a.createElement("svg",{viewBox:"0 0 14 16"},a.createElement("path",{fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))},label:a.createElement(i.Z,{id:"theme.admonition.note",description:"The default label used for the Note admonition (:::note)"},"note")},tip:{infimaClassName:"success",iconComponent:function(){return a.createElement("svg",{viewBox:"0 0 12 16"},a.createElement("path",{fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))},label:a.createElement(i.Z,{id:"theme.admonition.tip",description:"The default label used for the Tip admonition (:::tip)"},"tip")},danger:{infimaClassName:"danger",iconComponent:function(){return a.createElement("svg",{viewBox:"0 0 12 16"},a.createElement("path",{fillRule:"evenodd",d:"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"}))},label:a.createElement(i.Z,{id:"theme.admonition.danger",description:"The default label used for the Danger admonition (:::danger)"},"danger")},info:{infimaClassName:"info",iconComponent:function(){return a.createElement("svg",{viewBox:"0 0 14 16"},a.createElement("path",{fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))},label:a.createElement(i.Z,{id:"theme.admonition.info",description:"The default label used for the Info admonition (:::info)"},"info")},caution:{infimaClassName:"warning",iconComponent:function(){return a.createElement("svg",{viewBox:"0 0 16 16"},a.createElement("path",{fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))},label:a.createElement(i.Z,{id:"theme.admonition.caution",description:"The default label used for the Caution admonition (:::caution)"},"caution")}},m={secondary:"note",important:"info",success:"tip",warning:"danger"};function c(e){const{mdxAdmonitionTitle:t,rest:n}=function(e){const t=a.Children.toArray(e),n=t.find((e=>{var t;return a.isValidElement(e)&&"mdxAdmonitionTitle"===(null==(t=e.props)?void 0:t.mdxType)})),o=a.createElement(a.Fragment,null,t.filter((e=>e!==n)));return{mdxAdmonitionTitle:n,rest:o}}(e.children);return{...e,title:e.title??t,children:n}}function h(e){const{children:t,type:n,title:i,icon:h}=c(e),f=function(e){const t=m[e]??e;return p[t]||(console.warn(`No admonition config found for admonition type "${t}". Using Info as fallback.`),p.info)}(n),k=i??f.label,{iconComponent:y}=f,v=h??a.createElement(y,null);return a.createElement("div",{className:(0,o.Z)(r.k.common.admonition,r.k.common.admonitionType(e.type),"alert",`alert--${f.infimaClassName}`,l)},a.createElement("div",{className:s},a.createElement("span",{className:d},v),k),a.createElement("div",{className:u},t))}},5162:(e,t,n)=>{n.d(t,{Z:()=>i});var a=n(7294),o=n(6010);const r="tabItem_Ymn6";function i(e){let{children:t,hidden:n,className:i}=e;return a.createElement("div",{role:"tabpanel",className:(0,o.Z)(r,i),hidden:n},t)}},5488:(e,t,n)=>{n.d(t,{Z:()=>c});var a=n(7462),o=n(7294),r=n(6010),i=n(2389),l=n(7392),s=n(7094),d=n(2466);const u="tabList__CuJ",p="tabItem_LNqP";function m(e){var t;const{lazy:n,block:i,defaultValue:m,values:c,groupId:h,className:f}=e,k=o.Children.map(e.children,(e=>{if((0,o.isValidElement)(e)&&"value"in e.props)return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})),y=c??k.map((e=>{let{props:{value:t,label:n,attributes:a}}=e;return{value:t,label:n,attributes:a}})),v=(0,l.l)(y,((e,t)=>e.value===t.value));if(v.length>0)throw new Error(`Docusaurus error: Duplicate values "${v.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`);const g=null===m?m:m??(null==(t=k.find((e=>e.props.default)))?void 0:t.props.value)??k[0].props.value;if(null!==g&&!y.some((e=>e.value===g)))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${g}" but none of its children has the corresponding value. Available values are: ${y.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);const{tabGroupChoices:b,setTabGroupChoices:w}=(0,s.U)(),[N,T]=(0,o.useState)(g),C=[],{blockElementScrollPositionUntilNextRender:x}=(0,d.o5)();if(null!=h){const e=b[h];null!=e&&e!==N&&y.some((t=>t.value===e))&&T(e)}const E=e=>{const t=e.currentTarget,n=C.indexOf(t),a=y[n].value;a!==N&&(x(t),T(a),null!=h&&w(h,String(a)))},A=e=>{var t;let n=null;switch(e.key){case"ArrowRight":{const t=C.indexOf(e.currentTarget)+1;n=C[t]??C[0];break}case"ArrowLeft":{const t=C.indexOf(e.currentTarget)-1;n=C[t]??C[C.length-1];break}}null==(t=n)||t.focus()};return o.createElement("div",{className:(0,r.Z)("tabs-container",u)},o.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,r.Z)("tabs",{"tabs--block":i},f)},y.map((e=>{let{value:t,label:n,attributes:i}=e;return o.createElement("li",(0,a.Z)({role:"tab",tabIndex:N===t?0:-1,"aria-selected":N===t,key:t,ref:e=>C.push(e),onKeyDown:A,onFocus:E,onClick:E},i,{className:(0,r.Z)("tabs__item",p,null==i?void 0:i.className,{"tabs__item--active":N===t})}),n??t)}))),n?(0,o.cloneElement)(k.filter((e=>e.props.value===N))[0],{className:"margin-top--md"}):o.createElement("div",{className:"margin-top--md"},k.map(((e,t)=>(0,o.cloneElement)(e,{key:t,hidden:e.props.value!==N})))))}function c(e){const t=(0,i.Z)();return o.createElement(m,(0,a.Z)({key:String(t)},e))}},8566:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>d,default:()=>h,frontMatter:()=>s,metadata:()=>u,toc:()=>m});var a=n(7462),o=(n(7294),n(3905)),r=n(5488),i=n(5162),l=n(3612);const s={sidebar_position:2},d="Tus",u={unversionedId:"upload-strategies/tus",id:"upload-strategies/tus",title:"Tus",description:"The @uppy/tus plugin brings resumable file uploading with Tus to Uppy by wrapping the tus-js-client.",source:"@site/docs/upload-strategies/tus.mdx",sourceDirName:"upload-strategies",slug:"/upload-strategies/tus",permalink:"/uppy.io/pr-preview/pr-29/docs/upload-strategies/tus",draft:!1,editUrl:"https://github.com/transloadit/uppy.io/tree/main/docs/upload-strategies/tus.mdx",tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"tutorialSidebar",previous:{title:"Transloadit",permalink:"/uppy.io/pr-preview/pr-29/docs/upload-strategies/transloadit"},next:{title:"AWS S3",permalink:"/uppy.io/pr-preview/pr-29/docs/upload-strategies/aws-s3"}},p={},m=[{value:"When should I use it?",id:"when-should-i-use-it",level:2},{value:"Install",id:"install",level:2},{value:"Use",id:"use",level:2},{value:"API",id:"api",level:2},{value:"Options",id:"options",level:3},{value:"<code>id</code>",id:"id",level:4},{value:"<code>endpoint</code>",id:"endpoint",level:4},{value:"<code>headers</code>",id:"headers",level:4},{value:"<code>chunkSize</code>",id:"chunksize",level:4},{value:"<code>withCredentials</code>",id:"withcredentials",level:4},{value:"<code>overridePatchMethod</code>",id:"overridepatchmethod",level:4},{value:"<code>retryDelays</code>",id:"retrydelays",level:4},{value:"<code>onBeforeRequest(req, file)</code>",id:"onbeforerequestreq-file",level:4},{value:"<code>onShouldRetry: (err, retryAttempt, options, next)</code>",id:"onshouldretry-err-retryattempt-options-next",level:4},{value:"<code>allowedMetaFields</code>",id:"allowedmetafields",level:4},{value:"<code>limit</code>",id:"limit",level:4},{value:"Frequently Asked Questions",id:"frequently-asked-questions",level:2},{value:"How is file meta data stored?",id:"how-is-file-meta-data-stored",level:3},{value:"How do I change files before sending them?",id:"how-do-i-change-files-before-sending-them",level:3},{value:"How do I change (or move) files after sending them?",id:"how-do-i-change-or-move-files-after-sending-them",level:3},{value:"Which server do you recommend?",id:"which-server-do-you-recommend",level:3},{value:"Are there hosted Tus servers?",id:"are-there-hosted-tus-servers",level:3},{value:"Why Tus instead of directly uploading to AWS S3?",id:"why-tus-instead-of-directly-uploading-to-aws-s3",level:3}],c={toc:m};function h(e){let{components:t,...n}=e;return(0,o.kt)("wrapper",(0,a.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"tus"},"Tus"),(0,o.kt)("p",null,"The ",(0,o.kt)("inlineCode",{parentName:"p"},"@uppy/tus")," plugin brings resumable file uploading with ",(0,o.kt)("a",{parentName:"p",href:"http://tus.io"},"Tus")," to Uppy by wrapping the ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/tus/tus-js-client"},"tus-js-client"),"."),(0,o.kt)("h2",{id:"when-should-i-use-it"},"When should I use it?"),(0,o.kt)("admonition",{type:"tip"},(0,o.kt)("p",{parentName:"admonition"},"Not sure which upload strategy is best for you? Read \u201c",(0,o.kt)("a",{parentName:"p",href:"/docs/guides/choosing-upload-strategy"},"Choosing the upload strategy you need"),"\u201d.")),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://tus.io/"},"Tus")," is an open protocol for resumable uploads built on HTTP.\nThis means accidentally closing your tab or losing connection let\u2019s you continue, for instance, your 10GB upload\ninstead of starting all over."),(0,o.kt)("p",null,"It supports any language, any platform, and any network. You can checkout the ",(0,o.kt)("a",{parentName:"p",href:"https://tus.io/implementations.html"},"implementations")," to\nfind the implementation in your favorite language. You can store files on your self-hosted Tus server, but also use service integrations (such as S3) to store files\nexternally."),(0,o.kt)("p",null,"If you want reliable, resumable uploads: use ",(0,o.kt)("inlineCode",{parentName:"p"},"@uppy/tus")," to connect to your Tus server in a few lines of code."),(0,o.kt)("h2",{id:"install"},"Install"),(0,o.kt)(r.Z,{mdxType:"Tabs"},(0,o.kt)(i.Z,{value:"npm",label:"NPM",default:!0,mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},"npm install @uppy/tus\n"))),(0,o.kt)(i.Z,{value:"yarn",label:"Yarn",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},"yarn add @uppy/tus\n"))),(0,o.kt)(i.Z,{value:"cdn",label:"CDN",mdxType:"TabItem"},(0,o.kt)(l.Z,{type:"caution",mdxType:"Admonition"},(0,o.kt)("p",null,"The bundle consists of most Uppy plugins, so this method is not recommended for production, as your users will have to download all plugins when you are likely using only a few.")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-html"},'  \x3c!-- 1. Add CSS to `<head>` --\x3e\n  <link href="https://releases.transloadit.com/uppy/v2.9.0/uppy.min.css" rel="stylesheet">\n\n  \x3c!-- 2. Add JS before the closing `</body>` --\x3e\n  <script src="https://releases.transloadit.com/uppy/v2.9.0/uppy.min.js"><\/script>\n\n  \x3c!-- 3. Initialize --\x3e\n  <div id="uppy"></div>\n  <script>\n    var uppy = new Uppy.Uppy()\n    uppy.use(Uppy.Tus, { /* see options below */ })\n  <\/script>\n')))),(0,o.kt)("h2",{id:"use"},"Use"),(0,o.kt)("p",null,"A quick overview of the complete API."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js",metastring:"{10} showLineNumbers","{10}":!0,showLineNumbers:!0},"import Uppy from '@uppy/core'\nimport Dashboard from '@uppy/dashboard'\nimport Tus from '@uppy/tus'\n\nimport '@uppy/core/dist/style.min.css'\nimport '@uppy/dashboard/dist/style.min.css'\n\nconst uppy = new Uppy\n  .use(Dashboard, { inline: true, target: 'body' })\n  .use(Tus, { endpoint: 'https://tusd.tusdemo.net/files/' })\n")),(0,o.kt)("h2",{id:"api"},"API"),(0,o.kt)("h3",{id:"options"},"Options"),(0,o.kt)("admonition",{type:"info"},(0,o.kt)("p",{parentName:"admonition"},"All options are passed to ",(0,o.kt)("inlineCode",{parentName:"p"},"tus-js-client")," and we document the ones here that we added or changed.\nThis means you can also pass functions like ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/tus/tus-js-client/blob/master/docs/api.md#onafterresponse"},(0,o.kt)("inlineCode",{parentName:"a"},"onAfterResponse")),"."),(0,o.kt)("p",{parentName:"admonition"},"We recommended taking a look at the ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/tus/tus-js-client/blob/master/docs/api.md"},"API reference")," from ",(0,o.kt)("inlineCode",{parentName:"p"},"tus-js-client")," to know what is supported.")),(0,o.kt)("h4",{id:"id"},(0,o.kt)("inlineCode",{parentName:"h4"},"id")),(0,o.kt)("p",null,"A unique identifier for this plugin (",(0,o.kt)("inlineCode",{parentName:"p"},"string"),", default: ",(0,o.kt)("inlineCode",{parentName:"p"},"'Tus'"),")."),(0,o.kt)("h4",{id:"endpoint"},(0,o.kt)("inlineCode",{parentName:"h4"},"endpoint")),(0,o.kt)("p",null,"URL of the tus server (",(0,o.kt)("inlineCode",{parentName:"p"},"string"),", default: ",(0,o.kt)("inlineCode",{parentName:"p"},"null"),")."),(0,o.kt)("h4",{id:"headers"},(0,o.kt)("inlineCode",{parentName:"h4"},"headers")),(0,o.kt)("p",null,"An object or function returning an object with HTTP headers to send to send along requests (",(0,o.kt)("inlineCode",{parentName:"p"},"object | function"),", default: ",(0,o.kt)("inlineCode",{parentName:"p"},"null"),")."),(0,o.kt)("p",null,"Keys are header names, values are header values."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"const headers = {\n  authorization: `Bearer ${window.getCurrentUserToken()}`,\n}\n")),(0,o.kt)("p",null,"Header values can also be derived from file data by providing a function.\nThe function receives an ",(0,o.kt)("a",{parentName:"p",href:"/docs/uppy-core#working-with-uppy-files"},"Uppy file")," and must return an object where the keys are header names, and values are header values."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"const headers = (file) => {\n  return {\n    authorization: `Bearer ${window.getCurrentUserToken()}`,\n    expires: file.meta.expires,\n  }\n}\n")),(0,o.kt)("h4",{id:"chunksize"},(0,o.kt)("inlineCode",{parentName:"h4"},"chunkSize")),(0,o.kt)("p",null,"A number indicating the maximum size of a ",(0,o.kt)("inlineCode",{parentName:"p"},"PATCH")," request body in bytes (",(0,o.kt)("inlineCode",{parentName:"p"},"number"),", default: ",(0,o.kt)("inlineCode",{parentName:"p"},"Infinity"),")."),(0,o.kt)("admonition",{type:"caution"},(0,o.kt)("p",{parentName:"admonition"},"Do not set this value unless you are forced to.\nThe two valid reasons are described in the ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/tus/tus-js-client/blob/master/docs/api.md#chunksize"},"tus-js-client docs"),".")),(0,o.kt)("h4",{id:"withcredentials"},(0,o.kt)("inlineCode",{parentName:"h4"},"withCredentials")),(0,o.kt)("p",null,"Configure the requests to send Cookies using the ",(0,o.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/withCredentials"},(0,o.kt)("inlineCode",{parentName:"a"},"xhr.withCredentials"))," property (",(0,o.kt)("inlineCode",{parentName:"p"},"boolean"),", default: ",(0,o.kt)("inlineCode",{parentName:"p"},"false"),")."),(0,o.kt)("p",null,"The remote server must accept CORS and credentials."),(0,o.kt)("h4",{id:"overridepatchmethod"},(0,o.kt)("inlineCode",{parentName:"h4"},"overridePatchMethod")),(0,o.kt)("p",null,"Whether the ",(0,o.kt)("inlineCode",{parentName:"p"},"POST")," method should be used instead of ",(0,o.kt)("inlineCode",{parentName:"p"},"PATCH")," for transfering file chunks (",(0,o.kt)("inlineCode",{parentName:"p"},"boolean"),", default: ",(0,o.kt)("inlineCode",{parentName:"p"},"false"),")."),(0,o.kt)("p",null,"This may be necessary if a browser or the server does not support latter one.\nIn this case, a POST request will be made with the ",(0,o.kt)("inlineCode",{parentName:"p"},"X-HTTP-Method-Override: PATCH")," header.\nThe server must be able to detect it, and then handle the request as if PATCH would have been the method."),(0,o.kt)("h4",{id:"retrydelays"},(0,o.kt)("inlineCode",{parentName:"h4"},"retryDelays")),(0,o.kt)("p",null,"When uploading a chunk fails, automatically try again after the defined millisecond intervals (",(0,o.kt)("inlineCode",{parentName:"p"},"array<number>"),", default: ",(0,o.kt)("inlineCode",{parentName:"p"},"[0, 1000, 3000, 5000]"),")."),(0,o.kt)("p",null,"By default, we first retry instantly; if that fails, we retry after 1 second; if that fails, we retry after 3 seconds, etc."),(0,o.kt)("p",null,"Set to ",(0,o.kt)("inlineCode",{parentName:"p"},"null")," to disable automatic retries, and fail instantly if any chunk fails to upload."),(0,o.kt)("h4",{id:"onbeforerequestreq-file"},(0,o.kt)("inlineCode",{parentName:"h4"},"onBeforeRequest(req, file)")),(0,o.kt)("p",null,"Behaves like the ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/tus/tus-js-client/blob/master/docs/api.md#onbeforerequest"},(0,o.kt)("inlineCode",{parentName:"a"},"onBeforeRequest"))," function from ",(0,o.kt)("inlineCode",{parentName:"p"},"tus-js-client")," but with the added ",(0,o.kt)("inlineCode",{parentName:"p"},"file")," argument."),(0,o.kt)("h4",{id:"onshouldretry-err-retryattempt-options-next"},(0,o.kt)("inlineCode",{parentName:"h4"},"onShouldRetry: (err, retryAttempt, options, next)")),(0,o.kt)("p",null,"When an upload fails ",(0,o.kt)("inlineCode",{parentName:"p"},"onShouldRetry")," is called with the error and the default retry logic as the last argument (",(0,o.kt)("inlineCode",{parentName:"p"},"function"),")."),(0,o.kt)("p",null,"The default retry logic is an ",(0,o.kt)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/Exponential_backoff"},"exponential backoff")," algorithm triggered on HTTP 429 (Too Many Requests) errors.\nMeaning if your server (or proxy) returns HTTP 429 because it\u2019s being overloaded, @uppy/tus will find the ideal sweet spot to keep uploading without overloading."),(0,o.kt)("p",null,"If you want to extend this functionality, for instance to retry on unauthorized requests (to retrieve a new authentication token):"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"import Uppy from '@uppy/core'\nimport Tus from '@uppy/tus'\nnew Uppy().use(Tus, {\n  endpoint: '',\n  async onBeforeRequest (req) {\n    const token = await getAuthToken()\n    req.setHeader('Authorization', `Bearer ${token}`)\n  },\n  onShouldRetry (err, retryAttempt, options, next) {\n    if (err?.originalResponse?.getStatus() === 401) {\n      return true\n    }\n    return next(err)\n  },\n  async onAfterResponse (req, res) {\n    if (res.getStatus() === 401) {\n      await refreshAuthToken()\n    }\n  },\n})\n")),(0,o.kt)("h4",{id:"allowedmetafields"},(0,o.kt)("inlineCode",{parentName:"h4"},"allowedMetaFields")),(0,o.kt)("p",null,"Pass an array of field names to limit the metadata fields that will be added to uploads as ",(0,o.kt)("a",{parentName:"p",href:"https://tus.io/protocols/resumable-upload.html#upload-metadata"},"Tus Metadata")," (",(0,o.kt)("inlineCode",{parentName:"p"},"array"),", default: ",(0,o.kt)("inlineCode",{parentName:"p"},"null"),")."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Set this to ",(0,o.kt)("inlineCode",{parentName:"li"},"['name']")," to only send the ",(0,o.kt)("inlineCode",{parentName:"li"},"name")," field."),(0,o.kt)("li",{parentName:"ul"},"Set this to ",(0,o.kt)("inlineCode",{parentName:"li"},"null")," (the default) to send ",(0,o.kt)("em",{parentName:"li"},"all")," metadata fields."),(0,o.kt)("li",{parentName:"ul"},"Set this to an empty array ",(0,o.kt)("inlineCode",{parentName:"li"},"[]")," to not send any fields.")),(0,o.kt)("h4",{id:"limit"},(0,o.kt)("inlineCode",{parentName:"h4"},"limit")),(0,o.kt)("p",null,"Limit the amount of uploads going on at the same time (",(0,o.kt)("inlineCode",{parentName:"p"},"number"),", default: ",(0,o.kt)("inlineCode",{parentName:"p"},"5"),")."),(0,o.kt)("p",null,"Setting this to ",(0,o.kt)("inlineCode",{parentName:"p"},"0")," means no limit on concurrent uploads (not recommend)"),(0,o.kt)("h2",{id:"frequently-asked-questions"},"Frequently Asked Questions"),(0,o.kt)("admonition",{type:"info"},(0,o.kt)("p",{parentName:"admonition"},"The Tus website has extensive ",(0,o.kt)("a",{parentName:"p",href:"https://tus.io/faq.html"},"FAQ section"),", we recommend taking a look there as well if something is unclear.")),(0,o.kt)("h3",{id:"how-is-file-meta-data-stored"},"How is file meta data stored?"),(0,o.kt)("p",null,"Tus uses unique identifers for the file names to prevent naming collisions.\nTo still keep the meta data in place, Tus also uploads an extra ",(0,o.kt)("inlineCode",{parentName:"p"},".info")," file with the original file name and other meta data:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "ID":"00007a99d16d4eeb5a3e3c080b6f69da+JHZavdqPSK4VMtarg2yYcNiP8t_kDjN51lBYMJdEyr_wqEotVl8ZBRBSTnWKWenZBwHvbLNz5tQXYp2N7Vdol.04ysQAuw__suTJ4IsCljj0rjyWA6LvV4IwF5P2oom2",\n  "Size":1679852,\n  "SizeIsDeferred":false,\n  "Offset":0,\n  "MetaData":{\n    "filename":"cat.jpg",\n    "filetype":"image/jpeg"\n  },\n  "IsPartial":false,\n  "IsFinal":false,\n  "PartialUploads":null,\n  "Storage":{\n    "Bucket":"your-bucket",\n    "Key":"some-key",\n    "Type":"s3store"\n  }\n}\n')),(0,o.kt)("h3",{id:"how-do-i-change-files-before-sending-them"},"How do I change files before sending them?"),(0,o.kt)("p",null,"If you want to change the file names, you want to do that in ",(0,o.kt)("a",{parentName:"p",href:"/docs/uppy-core#onbeforefileaddedfile-files"},(0,o.kt)("inlineCode",{parentName:"a"},"onBeforeFileAdded")),"."),(0,o.kt)("p",null,"If you want to send extra headers with the request, use ",(0,o.kt)("a",{parentName:"p",href:"#headers"},(0,o.kt)("inlineCode",{parentName:"a"},"headers"))," or ",(0,o.kt)("a",{parentName:"p",href:"#onbeforerequestreq-file"},(0,o.kt)("inlineCode",{parentName:"a"},"onBeforeRequest")),"."),(0,o.kt)("h3",{id:"how-do-i-change-or-move-files-after-sending-them"},"How do I change (or move) files after sending them?"),(0,o.kt)("p",null,"If you want to preserve files names, extract meta data, or move files to a different place you generally can with hooks or events.\nIt depends on the Tus server you use how it\u2019s done exactly. ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/tus/tusd"},"tusd"),", for instance, exposes ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/tus/tusd/blob/master/docs/hooks.md"},"hooks"),"\nand ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/tus/tus-node-server"},"tus-node-server")," has ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/tus/tus-node-server#events"},"events"),"."),(0,o.kt)("h3",{id:"which-server-do-you-recommend"},"Which server do you recommend?"),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://transloadit.com"},"Transloadit")," runs ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/tus/tusd"},"tusd")," in production, where it serves millions of requests globally.\nTherefor we recommend tusd as battle-tested from our side, but other companies have had success with other implementations so it depends on your needs."),(0,o.kt)("h3",{id:"are-there-hosted-tus-servers"},"Are there hosted Tus servers?"),(0,o.kt)("p",null,"All ",(0,o.kt)("a",{parentName:"p",href:"https://transloadit.com/pricing"},"Transloadit plans")," come with a hosted ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/tus/tusd"},"tusd")," server.\nYou don\u2019t have to do anything to leverage it, using ",(0,o.kt)("a",{parentName:"p",href:"/docs/upload-strategies/transloadit"},(0,o.kt)("inlineCode",{parentName:"a"},"@uppy/transloadit"))," automatically\nuses Tus under the hood."),(0,o.kt)("h3",{id:"why-tus-instead-of-directly-uploading-to-aws-s3"},"Why Tus instead of directly uploading to AWS S3?"),(0,o.kt)("p",null,"First and foremost: reliable, resumable uploads.\nThis means accidentally closing your tab or losing connection let\u2019s you continue, for instance, your 10GB upload\ninstead of starting all over."),(0,o.kt)("p",null,"Tus is also efficient with lots of files (such as 8K) and large files.\nUploading to AWS S3 directly from the client also introduces quite a bit of overhead,\nas more requests are needed for the flow to work."))}h.isMDXComponent=!0}}]);