"use strict";(self.webpackChunkuppy_io=self.webpackChunkuppy_io||[]).push([[6969],{3905:(e,t,a)=>{a.d(t,{Zo:()=>u,kt:()=>c});var o=a(7294);function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,o)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function s(e,t){if(null==e)return{};var a,o,n=function(e,t){if(null==e)return{};var a,o,n={},r=Object.keys(e);for(o=0;o<r.length;o++)a=r[o],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)a=r[o],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var l=o.createContext({}),p=function(e){var t=o.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},u=function(e){var t=p(e.components);return o.createElement(l.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},m=o.forwardRef((function(e,t){var a=e.components,n=e.mdxType,r=e.originalType,l=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),m=p(a),c=n,h=m["".concat(l,".").concat(c)]||m[c]||d[c]||r;return a?o.createElement(h,i(i({ref:t},u),{},{components:a})):o.createElement(h,i({ref:t},u))}));function c(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var r=a.length,i=new Array(r);i[0]=m;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:n,i[1]=s;for(var p=2;p<r;p++)i[p]=a[p];return o.createElement.apply(null,i)}return o.createElement.apply(null,a)}m.displayName="MDXCreateElement"},2683:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>d,frontMatter:()=>r,metadata:()=>s,toc:()=>p});var o=a(7462),n=(a(7294),a(3905));const r={title:"Uppy 3.0: Future-proof, conveniently easy, stable as ever",date:new Date("2022-09-13T00:00:00.000Z"),authors:["aduh95","arturi","mifi","murderlon"],image:"https://uppy.io/img/blog/3.0/uppy-3-0.jpg",published:!0,slug:"2022/09/3.0"},i=void 0,s={permalink:"/uppy.io/pr-preview/pr-40/blog/2022/09/3.0",editUrl:"https://github.com/transloadit/uppy.io/tree/main/blog/2022-09-3.0.md",source:"@site/blog/2022-09-3.0.md",title:"Uppy 3.0: Future-proof, conveniently easy, stable as ever",description:"Screenshot of Uppy 3.0.0 UI",date:"2022-09-13T00:00:00.000Z",formattedDate:"September 13, 2022",tags:[],readingTime:6.655,hasTruncateMarker:!0,authors:[{email:"antoine@transloadit.com",name:"Antoine du Hamel",id:"aduh95",tagline:"Developer",imageURL:"https://github.com/aduh95.png",key:"aduh95"},{email:"artur@transloadit.com",name:"Artur Paikin",id:"artur",tagline:"Developer",imageURL:"https://github.com/arturi.png",key:"arturi"},{email:"mikael@transloadit.com",name:"Mikael Finstad",id:"mikael",tagline:"Developer",imageURL:"https://github.com/mifi.png",key:"mifi"},{email:"merlijn@transloadit.com",name:"Merlijn Vos",id:"merlijn",tagline:"Developer",imageURL:"https://github.com/murderlon.png",key:"murderlon"}],frontMatter:{title:"Uppy 3.0: Future-proof, conveniently easy, stable as ever",date:"2022-09-13T00:00:00.000Z",authors:["aduh95","arturi","mifi","murderlon"],image:"https://uppy.io/img/blog/3.0/uppy-3-0.jpg",published:!0,slug:"2022/09/3.0"},nextItem:{title:"Uppy 2.4-2.7: Image Compressor, Transloadit Rate Limiting, ESM",permalink:"/uppy.io/pr-preview/pr-40/blog/2022/03/2.4/2.7"}},l={authorsImageUrls:[void 0,void 0,void 0,void 0]},p=[{value:"ESM surgery",id:"esm-surgery",level:2},{value:"Less integration code with the new remote sources preset",id:"less-integration-code-with-the-new-remote-sources-preset",level:2},{value:"Robodog ends its service",id:"robodog-ends-its-service",level:2},{value:"Native mobile camera",id:"native-mobile-camera",level:2},{value:"Devotedly stable",id:"devotedly-stable",level:2},{value:"Companion turns 4.0",id:"companion-turns-40",level:2},{value:"Streaming upload",id:"streaming-upload",level:3},{value:"Event emitter",id:"event-emitter",level:3},{value:"Internal improvements",id:"internal-improvements",level:3},{value:"And more!",id:"and-more",level:3}],u={toc:p};function d(e){let{components:t,...r}=e;return(0,n.kt)("wrapper",(0,o.Z)({},u,r,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"Screenshot of Uppy 3.0.0 UI",src:a(6397).Z,width:"1200",height:"630"})),(0,n.kt)("blockquote",null,(0,n.kt)("p",{parentName:"blockquote"},"For those new to Uppy, coming from Reddit, Hacker News and Product Hunt today: Uppy is a popular open source file uploader for the browser. Pick files from local disk or camera, remote sources like Instagram, Unsplash, Dropbox etc, record audio and screencasts. Crop and tweak images with the image editor plugin. Supports resumable uploads to a tus.io server, AWS S3 (and many others with similar API like DigitalOcean), multipart. ",(0,n.kt)("a",{parentName:"p",href:"https://uppy.io/examples/dashboard"},"Try it"),"!")),(0,n.kt)("p",null,"Uppy is turning three! When you\u2019re counting in ",(0,n.kt)("a",{parentName:"p",href:"https://www.akc.org/expert-advice/health/how-to-calculate-dog-years-to-human-years/"},"dog years")," \u2013 which we most certainly are \u2013 that\u2019s 29 already. An age like that signifies proper adulthood. For Uppy, this means it\u2019s ready to stay loyal, but without the silly mistakes (read: bugs). Uppy also underwent (ESM) surgery to keep it strolling by your side in the current ecosystem, and received other behavioral improvements \ud83d\udc36"),(0,n.kt)("p",null,"TL;DR: ESM transition, native mobile camera, new Remote Sources plugin, sweeping Companion rewrite and streaming support, ",(0,n.kt)("inlineCode",{parentName:"p"},"async"),"/",(0,n.kt)("inlineCode",{parentName:"p"},"await")," everything, React 18 and Vue 3 support, all examples rewritten."),(0,n.kt)("h2",{id:"esm-surgery"},"ESM surgery"),(0,n.kt)("p",null,(0,n.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Modules"},"ECMAScript Modules")," (ESM) are the future and we\u2019re ready to adopt it. Benefits over CommonJS include: improved security, better tree shaking, and a syntax that can be understood natively by browsers, which can greatly improve the DX if the tools are configured to take advantage of that."),(0,n.kt)("p",null,"Following in the footsteps of many other packages, we now only ship Uppy core and its plugins as ESM. For Uppy 2.x, we were shipping CommonJS."),(0,n.kt)("p",null,"If you are already using ESM or the CDN builds, nothing changes for you! If you are using CommonJS, you may have to add extra tooling for everything to work, or consider refactoring your codebase to ESM. Please refer to the ",(0,n.kt)("a",{parentName:"p",href:"https://gist.github.com/sindresorhus/a39789f98801d908bbc7ff3ecc99d99c"},"Pure ESM package gist")," for more information and help on how to do that."),(0,n.kt)("h2",{id:"less-integration-code-with-the-new-remote-sources-preset"},"Less integration code with the new remote sources preset"),(0,n.kt)("p",null,"We\u2019ve introduced a new Uppy preset plugin, ",(0,n.kt)("a",{parentName:"p",href:"/docs/remote-sources"},(0,n.kt)("inlineCode",{parentName:"a"},"@uppy/remote-sources")),", which combines Instagram, Facebook, Google Drive, Box, Unsplash, Dropbox, One Drive, Zoom and any other remote cloud sources that Uppy will support in the future. The plugin only works with Dashboard and allows you to enable all the above sources in a single line."),(0,n.kt)("p",null,"Before, you had to manually include every cloud provider / remote source:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-js"},"uppy\n  .use(Instagram, { companionUrl: COMPANION_URL, companionAllowedHosts: COMPANION_ALLOWED_HOSTS })\n  .use(GoogleDrive, { companionUrl: COMPANION_URL, companionAllowedHosts: COMPANION_ALLOWED_HOSTS })\n  .use(OneDrive, { companionUrl: COMPANION_URL, companionAllowedHosts: COMPANION_ALLOWED_HOSTS })\n  .use(Instagram, { companionUrl: COMPANION_URL, companionAllowedHosts: COMPANION_ALLOWED_HOSTS })\n  .use(Facebook, { companionUrl: COMPANION_URL, companionAllowedHosts: COMPANION_ALLOWED_HOSTS })\n  .use(Unsplash, { companionUrl: COMPANION_URL, companionAllowedHosts: COMPANION_ALLOWED_HOSTS })\n  // ...\n")),(0,n.kt)("p",null,"After:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-js"},"uppy.use(RemoteSources, { companionUrl: COMPANION_URL })\n")),(0,n.kt)("p",null,"To get started, check out the ",(0,n.kt)("a",{parentName:"p",href:"/docs/remote-sources"},(0,n.kt)("inlineCode",{parentName:"a"},"RemoteSources")," docs"),"."),(0,n.kt)("h2",{id:"robodog-ends-its-service"},"Robodog ends its service"),(0,n.kt)("p",null,"Uppy is flexible and extensible through plugins, but the integration code could sometimes prove daunting. This is what brought ",(0,n.kt)("a",{parentName:"p",href:"/docs/robodog/"},"Robodog")," to life. It served as an alternative with the same features, but with a more ergonomic and minimal API."),(0,n.kt)("p",null,"It did, however, come with its own set of new problems:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Robodog tries to do the exact same thing as Uppy, but looks like an entirely different product."),(0,n.kt)("li",{parentName:"ul"},"Users are faced with a confusing choice between using Robodog or using Uppy directly."),(0,n.kt)("li",{parentName:"ul"},"Robodog is more ergonomic because it\u2019s limited. When hitting such a limit, the user has to refactor everything to Uppy using plugins.")),(0,n.kt)("p",null,"This has now led us to deprecating Robodog and embracing Uppy for its strong suits: modularity and flexibility. At the same time, we\u2019re also introducing something to take away some of the repetitive integration code: ",(0,n.kt)("a",{parentName:"p",href:"/docs/remote-sources"},(0,n.kt)("inlineCode",{parentName:"a"},"@uppy/remote-sources")),"."),(0,n.kt)("p",null,"Are you using Robodog in your code base? You can check out the ",(0,n.kt)("a",{parentName:"p",href:"https://uppy.io/docs/migration-guides.html#Migrate-from-Robodog-to-Uppy-plugins"},"migration guide")," to see how you can transition to Uppy plugins without losing functionality. We have committed ourselves to extending Robodog support for one year to give our users more time to migrate."),(0,n.kt)("h2",{id:"native-mobile-camera"},"Native mobile camera"),(0,n.kt)("p",null,"As you are probably aware, Uppy\u2019s Webcam plugin provides a nice UI for desktop devices to take pictures and record videos. Up until 3.0, the same UI was utilized on mobile as well."),(0,n.kt)("p",null,"Since most mobile devices have a system UI for taking pictures and recording videos \u2013 which is usually better than any custom solution we can offer \u2013 we\u2019ve introduced a new option called ",(0,n.kt)("inlineCode",{parentName:"p"},"mobileNativeCamera")," for the Webcam plugin:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-js"},"uppy.use(Webcam, {\n  mobileNativeCamera: isMobile({ tablet: true }),\n})\n")),(0,n.kt)("p",null,"By default, it uses the ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/juliangruber/is-mobile"},(0,n.kt)("inlineCode",{parentName:"a"},"is-mobile"))," package to detect mobile devices, like smartphones and tablets, but you can manually set this option to ",(0,n.kt)("inlineCode",{parentName:"p"},"true")," or ",(0,n.kt)("inlineCode",{parentName:"p"},"false")," if you wish. When enabled, instead of the usual Camera/Webcam Uppy UI, users will be presented with buttons that open their device\u2019s native camera interface:"),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"Uppy native camera UI",src:a(3241).Z,width:"1430",height:"1321"})),(0,n.kt)("p",null,(0,n.kt)("a",{parentName:"p",href:"/docs/webcam/#videoConstraints"},(0,n.kt)("inlineCode",{parentName:"a"},"videoConstraints.facingMode"))," is also supported by this option via the ",(0,n.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Web/HTML/Attributes/capture"},(0,n.kt)("inlineCode",{parentName:"a"},"capture"))," attribute (in the browsers and devices that respect it)."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-js"},"uppy.use(Webcam, {\n  videoConstraints: {\n    facingMode: 'user',\n  },\n})\n")),(0,n.kt)("p",null,"The same applies to ",(0,n.kt)("a",{parentName:"p",href:"/docs/webcam/#modes"},(0,n.kt)("inlineCode",{parentName:"a"},"modes")),", allowing you to enable only video or only photos."),(0,n.kt)("h2",{id:"devotedly-stable"},"Devotedly stable"),(0,n.kt)("p",null,"Since the Uppy 2.7.0 release, ",(0,n.kt)("strong",{parentName:"p"},"we\u2019ve fixed over 95 bugs!")," This includes fixes to bugs that made uploading less stable, documentation corrections, and dependency upgrades."),(0,n.kt)("h2",{id:"companion-turns-40"},"Companion turns 4.0"),(0,n.kt)("p",null,"Everyone\u2019s favorite Companion also received some love."),(0,n.kt)("h3",{id:"streaming-upload"},"Streaming upload"),(0,n.kt)("p",null,"Streaming upload can now also be enabled in Companion when using Tus. This comes with greatly improved upload speeds and allows uploading up to hundreds of gigabytes without needing a large server storage. We found that this improves speeds by about 37% for a Google Drive upload of a 1 GB file (",(0,n.kt)("a",{parentName:"p",href:"https://github.com/transloadit/uppy/pull/4046#issuecomment-1235697937"},"source"),"). This feature was also available before Companion 4.0, but it didn\u2019t work with Tus until now."),(0,n.kt)("p",null,"With streaming upload disabled (default), the whole file will be downloaded first. The upload will then start when the download has completely finished."),(0,n.kt)("p",null,"When streaming upload is enabled, Companion will start downloading the file from the provider (such as Google Drive), while at the same time starting the upload to the destination (such as Tus), and sending every chunk of data consecutively."),(0,n.kt)("p",null,"For more information, see the ",(0,n.kt)("a",{parentName:"p",href:"/docs/companion/"},"Companion docs"),"."),(0,n.kt)("h3",{id:"event-emitter"},"Event emitter"),(0,n.kt)("p",null,"Companion now has a server-side event emitter that can be used to detect when uploads start, finish and fail, without having to depend on the client (so it works even when users have closed their browser)."),(0,n.kt)("p",null,"Example code:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-js"},"const { app, emitter } = companion.app(options)\n\nemitter.on('upload-start', ({ token }) => {\n  console.log('Upload started', token)\n\n  function onUploadEvent ({ action, payload }) {\n    if (action === 'success') {\n      emitter.off(token, onUploadEvent) // avoid listener leak\n      console.log('Upload finished', token, payload.url)\n    } else if (action === 'error') {\n      emitter.off(token, onUploadEvent) // avoid listener leak\n      console.error('Upload failed', payload)\n    }\n  }\n  emitter.on(token, onUploadEvent)\n})\n")),(0,n.kt)("h3",{id:"internal-improvements"},"Internal improvements"),(0,n.kt)("p",null,"Companion\u2019s internal request code and Providers have been rewritten to ",(0,n.kt)("inlineCode",{parentName:"p"},"async"),"/",(0,n.kt)("inlineCode",{parentName:"p"},"await"),", which has greatly simplified and reduced the amount of code. This will lead to less bugs and security issues, and make it easier to implement new custom Providers."),(0,n.kt)("p",null,"We have also replaced the deprecated ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/request/request"},(0,n.kt)("inlineCode",{parentName:"a"},"request"))," library with ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/sindresorhus/got"},(0,n.kt)("inlineCode",{parentName:"a"},"got")),". This also removed the need for ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/simov/purest"},(0,n.kt)("inlineCode",{parentName:"a"},"purest")),"."),(0,n.kt)("h3",{id:"and-more"},"And more!"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"/docs/compressor"},"Compressor")," is officially stable. The Compressor plugin for Uppy optimizes images (JPEG, PNG), saving on average up to 60% in size. It has proven itself through extensive battle testing."),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"/docs/aws-s3-multipart"},"AWS S3 Multipart")," also became more stable this release, as a result of us hammering out some of the last edge cases with lots of files and/or huge files."),(0,n.kt)("li",{parentName:"ul"},"React 18 is now supported in ",(0,n.kt)("a",{parentName:"li",href:"/docs/react"},(0,n.kt)("inlineCode",{parentName:"a"},"@uppy/react")),", Vue 3 is supported for ",(0,n.kt)("a",{parentName:"li",href:"/docs/vue"},(0,n.kt)("inlineCode",{parentName:"a"},"@uppy/vue")),", and Angular 14 for ",(0,n.kt)("a",{parentName:"li",href:"/docs/angular"},(0,n.kt)("inlineCode",{parentName:"a"},"@uppy/angular")),"."),(0,n.kt)("li",{parentName:"ul"},"Our ",(0,n.kt)("a",{parentName:"li",href:"https://github.com/transloadit/uppy/tree/main/examples"},"examples")," have received a fresh round of updates to keep them relevant.")),(0,n.kt)("hr",null),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"Animate picture of a visibly happy dog getting a head massage",src:a(1981).Z,width:"400",height:"286"})),(0,n.kt)("p",null,"For more details, see the full ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/transloadit/uppy/blob/HEAD/CHANGELOG.md#1300"},"changelog")," and the ",(0,n.kt)("a",{parentName:"p",href:"/docs/migration-guides.html"},"migration guide"),"."),(0,n.kt)("p",null,"That\u2019s it from us for now! As you can see, Uppy may be slowly turning into an old dog, but we\u2019re still committed to keep teaching it new tricks. We hope you\u2019ll enjoy this latest major release, and all the features and improvements it includes. We can\u2019t wait to hear your thoughts about it on ",(0,n.kt)("a",{parentName:"p",href:"https://twitter.com/uppy_io"},"Twitter"),"!"))}d.isMDXComponent=!0},1981:(e,t,a)=>{a.d(t,{Z:()=>o});const o=a.p+"assets/images/dog-enjoys-875f8d3432b4fa5d05df0255f83c655a.gif"},3241:(e,t,a)=>{a.d(t,{Z:()=>o});const o=a.p+"assets/images/native-camera-d180107e4e1d511e85c203b1d6b49cb9.jpg"},6397:(e,t,a)=>{a.d(t,{Z:()=>o});const o=a.p+"assets/images/uppy-3-0-71a46f198071d75565646ce69236acec.jpg"}}]);